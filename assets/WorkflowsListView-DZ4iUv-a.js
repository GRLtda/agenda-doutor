import{_ as K,g as Q,h as Y,a as Z,r as v,i as ee,j as se,c as f,o as d,b as e,k as B,l as V,e as t,m as n,n as m,p as a,P as S,A as p,a5 as E,a1 as te,a6 as oe,F as T,t as $,x as k,y as L,z as y,d as A,E as le,B as ae,C as ne,G as ie,a7 as j,v as F,X as g,I,f as U}from"./index-D0Sslu2F.js";import{u as re}from"./workflows-CcIfcbEd.js";const de={class:"workflows-list-page"},ue={class:"page-header"},ce={class:"header-actions"},ve={class:"table-container"},fe={class:"th-content"},me={class:"th-content"},pe={class:"th-content"},ke={key:1},we={colspan:"5",class:"state-cell"},_e={class:"empty-state-content"},be={class:"empty-state-icon-bg"},he=["onClick"],Ce={class:"workflow-icon"},ye={class:"workflow-info"},ge={class:"workflow-name"},xe={class:"workflow-desc"},ze={class:"actions-wrapper"},We=["onClick"],De={key:0,class:"actions-dropdown"},Ve=["onClick"],Ee=["onClick"],Ae={class:"drawer-header"},Me={class:"workflow-form"},Ne={class:"form-group"},Be={class:"drawer-footer"},Se={class:"drawer-header"},Te={class:"workflow-form"},$e={class:"form-group"},Le={class:"drawer-footer"},je={__name:"WorkflowsListView",setup(Fe){const u=re(),M=Q(),x=Y(),w=Z(()=>u.workflows),c=v(null),z=v(!1),r=v({name:"",description:""}),_=v(!1),W=v(!1),i=v({_id:null,name:"",description:""}),b=v(!1);ee(async()=>{await u.fetchWorkflows()});function q(l){c.value!==l&&M.push(`/app/workflows/${l}`)}function O(l){c.value=c.value===l?null:l}function N(){r.value={name:"",description:""},z.value=!0}function h(){z.value=!1,r.value={name:"",description:""}}async function P(){if(!r.value.name.trim()){x.error("O nome do workflow é obrigatório.");return}_.value=!0;try{const l=await u.createWorkflow({name:r.value.name.trim(),description:r.value.description.trim()});h(),M.push(`/app/workflows/${l._id}`)}catch{}finally{_.value=!1}}async function R(l){confirm("Tem certeza que deseja excluir este workflow?")&&await u.deleteWorkflow(l),c.value=null}function G(l){i.value={_id:l._id,name:l.name,description:l.description||""},c.value=null,W.value=!0}function C(){W.value=!1,i.value={_id:null,name:"",description:""}}async function X(){if(!i.value.name.trim()){x.error("O nome do workflow é obrigatório.");return}b.value=!0;try{await u.updateWorkflow(i.value._id,{name:i.value.name.trim(),description:i.value.description.trim()}),x.success("Workflow atualizado com sucesso!"),C()}catch{}finally{b.value=!1}}function H(l){return l?new Date(l).toLocaleDateString("pt-BR"):"-"}return(l,s)=>{const J=se("click-outside");return d(),f("div",de,[e("header",ue,[s[6]||(s[6]=e("div",{class:"header-text"},[e("h1",{class:"title"},"Workflows"),e("p",{class:"subtitle"},"Automatize processos e gerencie fluxos de trabalho.")],-1)),e("div",ce,[t(p,{variant:"primary",onClick:N,class:"add-btn"},{default:n(()=>[t(a(S),{size:16}),s[5]||(s[5]=m(" Novo Workflow ",-1))]),_:1})])]),e("div",{class:L(["table-wrapper",{"is-loading":a(u).loading&&w.value.length>0}])},[e("div",ve,[e("table",null,[e("thead",null,[e("tr",null,[s[10]||(s[10]=e("th",{class:"icon-header"},null,-1)),e("th",null,[e("div",fe,[t(a(E),{size:14}),s[7]||(s[7]=e("span",null,"Nome",-1))])]),e("th",null,[e("div",me,[t(a(te),{size:14}),s[8]||(s[8]=e("span",null,"Status",-1))])]),e("th",null,[e("div",pe,[t(a(oe),{size:14}),s[9]||(s[9]=e("span",null,"Criado em",-1))])]),s[11]||(s[11]=e("th",{class:"actions-header"},[e("div",{class:"th-content"},[e("span",null,"Ações")])],-1))])]),e("tbody",null,[a(u).loading&&w.value.length===0?(d(),f(T,{key:0},$(5,o=>e("tr",{key:`skel-${o}`,class:"skeleton-row"},[...s[12]||(s[12]=[e("td",null,[e("div",{class:"skeleton skeleton-icon"})],-1),e("td",null,[e("div",{class:"skeleton skeleton-text",style:{width:"60%"}})],-1),e("td",null,[e("div",{class:"skeleton skeleton-text",style:{width:"40%"}})],-1),e("td",null,[e("div",{class:"skeleton skeleton-text",style:{width:"30%"}})],-1),e("td",{class:"actions-cell"},[e("div",{class:"skeleton skeleton-button"})],-1)])])),64)):!a(u).loading&&w.value.length===0?(d(),f("tr",ke,[e("td",we,[e("div",_e,[e("div",be,[t(a(E),{size:24})]),s[14]||(s[14]=e("h3",{class:"empty-state-title"},"Nenhum workflow encontrado",-1)),s[15]||(s[15]=e("p",{class:"empty-state-text"}," Crie seu primeiro fluxo de automação. ",-1)),t(p,{variant:"primary",onClick:N,class:"btn-primary-sm"},{default:n(()=>[t(a(S),{size:16}),s[13]||(s[13]=e("span",null,"Criar Workflow",-1))]),_:1})])])])):(d(!0),f(T,{key:2},$(w.value,o=>(d(),f("tr",{key:o._id,class:"workflow-row",onClick:D=>q(o._id)},[e("td",null,[e("div",Ce,[t(a(E),{size:20})])]),e("td",null,[e("div",ye,[e("span",ge,k(o.name),1),e("span",xe,k(o.description),1)])]),e("td",null,[e("span",{class:L(["status-badge",{active:o.isActive}])},k(o.isActive?"Ativo":"Inativo"),3)]),e("td",null,k(H(o.createdAt)),1),e("td",{class:"actions-cell",onClick:s[0]||(s[0]=y(()=>{},["stop"]))},[A((d(),f("div",ze,[e("button",{onClick:y(D=>O(o._id),["stop"]),class:"btn-icon"},[t(a(le),{size:20})],8,We),t(ie,{name:"fade"},{default:n(()=>[c.value===o._id?(d(),f("div",De,[e("button",{onClick:y(D=>G(o),["stop"]),class:"dropdown-item"},[t(a(ae),{size:14}),s[16]||(s[16]=m(" Editar ",-1))],8,Ve),e("button",{onClick:y(D=>R(o._id),["stop"]),class:"dropdown-item delete"},[t(a(ne),{size:14}),s[17]||(s[17]=m(" Excluir ",-1))],8,Ee)])):V("",!0)]),_:2},1024)])),[[J,()=>c.value=null]])])],8,he))),128))])])])],2),z.value?(d(),B(U,{key:0,onClose:h},{header:n(()=>[e("div",Ae,[s[18]||(s[18]=e("div",{class:"header-left"},[e("h2",{class:"drawer-title"},"Novo Workflow"),e("span",{class:"drawer-subtitle"},"Defina o nome e descrição do seu workflow")],-1)),e("button",{onClick:h,class:"close-btn-header"},[t(a(g),{size:24})])])]),footer:n(()=>[e("div",Be,[t(p,{variant:"default",onClick:h,class:"btn-cancel"},{default:n(()=>[t(a(g),{size:18}),s[20]||(s[20]=m(" Cancelar ",-1))]),_:1}),t(p,{variant:"secondary",onClick:P,disabled:_.value||!r.value.name.trim(),class:"btn-save"},{default:n(()=>[t(a(I),{size:18}),m(" "+k(_.value?"Criando...":"Criar Workflow"),1)]),_:1},8,["disabled"])])]),default:n(()=>[e("div",Me,[t(j,{modelValue:r.value.name,"onUpdate:modelValue":s[1]||(s[1]=o=>r.value.name=o),label:"Nome do Workflow",placeholder:"Ex: Lembrete de consulta",required:!0},null,8,["modelValue"]),e("div",Ne,[s[19]||(s[19]=e("label",{class:"form-label"},"Descrição",-1)),A(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=o=>r.value.description=o),class:"form-textarea",placeholder:"Descreva o objetivo deste workflow...",rows:"4"},null,512),[[F,r.value.description]])])])]),_:1})):V("",!0),W.value?(d(),B(U,{key:1,onClose:C},{header:n(()=>[e("div",Se,[s[21]||(s[21]=e("div",{class:"header-left"},[e("h2",{class:"drawer-title"},"Editar Workflow"),e("span",{class:"drawer-subtitle"},"Atualize as informações do seu workflow")],-1)),e("button",{onClick:C,class:"close-btn-header"},[t(a(g),{size:24})])])]),footer:n(()=>[e("div",Le,[t(p,{variant:"default",onClick:C,class:"btn-cancel"},{default:n(()=>[t(a(g),{size:18}),s[23]||(s[23]=m(" Cancelar ",-1))]),_:1}),t(p,{variant:"secondary",onClick:X,disabled:b.value||!i.value.name.trim(),class:"btn-save"},{default:n(()=>[t(a(I),{size:18}),m(" "+k(b.value?"Salvando...":"Salvar Alterações"),1)]),_:1},8,["disabled"])])]),default:n(()=>[e("div",Te,[t(j,{modelValue:i.value.name,"onUpdate:modelValue":s[3]||(s[3]=o=>i.value.name=o),label:"Nome do Workflow",placeholder:"Ex: Lembrete de consulta",required:!0},null,8,["modelValue"]),e("div",$e,[s[22]||(s[22]=e("label",{class:"form-label"},"Descrição",-1)),A(e("textarea",{"onUpdate:modelValue":s[4]||(s[4]=o=>i.value.description=o),class:"form-textarea",placeholder:"Descreva o objetivo deste workflow...",rows:"4"},null,512),[[F,i.value.description]])])])]),_:1})):V("",!0)])}}},qe=K(je,[["__scopeId","data-v-7bc5b904"]]);export{qe as default};
