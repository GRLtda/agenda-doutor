import{_ as B,r as w,w as Y,c,o as i,a as G,b as e,d as z,v as A,e as l,S as Z,f as J,u as ee,g as se,h as te,i as oe,j as R,k as L,l as g,m as y,n as h,p as a,P as E,A as S,q as N,D as le,T as ae,s as ne,F as I,t as D,x as f,y as F,z as k,E as O,B as q,C as X,G as j,H as ie,X as H,L as de,I as re}from"./index-D0Sslu2F.js";const ce=["value","placeholder"],ue={__name:"CurrencyInput",props:{modelValue:{type:Number,default:0},placeholder:{type:String,default:"R$ 0,00"}},emits:["update:modelValue"],setup(V,{emit:p}){const _=V,m=p,d=w(null),r=w(""),b=n=>n==null?"":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n),v=n=>Number(n.replace(/[^0-9]/g,""))/100,t=n=>{const C=n.target.value,P=v(C);m("update:modelValue",P),r.value=b(P)};return Y(()=>_.modelValue,n=>{r.value=b(n)},{immediate:!0}),(n,C)=>(i(),c("input",{ref_key:"inputRef",ref:d,type:"text",class:"currency-input",value:r.value,onInput:t,placeholder:V.placeholder},null,40,ce))}},pe=B(ue,[["__scopeId","data-v-68678f30"]]),me={class:"procedure-form"},ve={class:"form-section"},_e={class:"section-card"},fe={class:"form-group"},be={class:"form-group"},ye={class:"form-section"},ke={class:"section-card"},ge={class:"form-group"},he={class:"price-row"},Ce={class:"price-col type-col"},we={class:"price-col value-col"},Ve={__name:"ProcedureForm",props:{modelValue:{type:Object,required:!0,default:()=>({name:"",description:"",baseValue:0,pricingType:"FIXED"})}},emits:["update:modelValue"],setup(V,{emit:p}){const _=V,m=p,d=G({get:()=>_.modelValue,set:v=>m("update:modelValue",v)}),r=[{value:"FIXED",label:"Preço Fixo"},{value:"UNIT",label:"Por Unidade"},{value:"ML",label:"Por mL"}],b=v=>{const t=v.target;t.style.height="auto",t.style.height=t.scrollHeight+"px"};return(v,t)=>(i(),c("div",me,[e("section",ve,[t[6]||(t[6]=e("h3",{class:"section-title"},"Dados do Procedimento",-1)),e("div",_e,[e("div",fe,[t[4]||(t[4]=e("label",{for:"name",class:"form-label"},"Nome do Procedimento *",-1)),z(e("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=n=>d.value.name=n),type:"text",class:"form-input",placeholder:"Ex: Consulta, Limpeza, etc.",required:""},null,512),[[A,d.value.name]])]),e("div",be,[t[5]||(t[5]=e("label",{for:"description",class:"form-label"},"Descrição",-1)),z(e("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=n=>d.value.description=n),class:"form-textarea",placeholder:"Descrição opcional do procedimento",rows:"3",onInput:b},null,544),[[A,d.value.description]])])])]),e("section",ye,[t[10]||(t[10]=e("h3",{class:"section-title"},"Precificação",-1)),e("div",ke,[e("div",ge,[t[9]||(t[9]=e("label",{class:"form-label"},"Configuração de Preço",-1)),e("div",he,[e("div",Ce,[t[7]||(t[7]=e("label",{class:"sub-label"},"Tipo de Cobrança",-1)),l(Z,{modelValue:d.value.pricingType,"onUpdate:modelValue":t[2]||(t[2]=n=>d.value.pricingType=n),options:r},null,8,["modelValue"])]),e("div",we,[t[8]||(t[8]=e("label",{class:"sub-label"},"Valor Base",-1)),l(pe,{modelValue:d.value.baseValue,"onUpdate:modelValue":t[3]||(t[3]=n=>d.value.baseValue=n),placeholder:"R$ 0,00"},null,8,["modelValue"])])])])])])]))}},K=B(Ve,[["__scopeId","data-v-82d8c98d"]]),Pe={class:"procedures-page"},xe={class:"page-header"},ze={class:"header-actions"},$e={class:"table-container desktop-only"},Te={class:"col-name"},Ne={class:"th-content"},Ie={class:"th-content"},De={class:"col-type"},Le={class:"th-content"},Ee={class:"actions-header"},Se={class:"th-content"},Fe={key:1},Be={colspan:"4",class:"state-cell"},Me={class:"empty-state-content"},Ue={class:"empty-state-icon-bg"},Ae={class:"procedure-name"},Re={class:"name-wrapper"},Oe={class:"name"},qe={key:0,class:"description"},Xe={class:"procedure-value"},je={class:"procedure-type"},He={class:"actions-wrapper"},Ge=["onClick"],Je={key:0,class:"actions-dropdown"},Ke=["onClick"],Qe=["onClick"],We={class:"mobile-list"},Ye={class:"procedure-info-mobile"},Ze={class:"procedure-icon"},es={class:"procedure-details-mobile"},ss={class:"procedure-name"},ts={class:"procedure-value"},os=["onClick"],ls={key:0,class:"actions-dropdown"},as=["onClick"],ns=["onClick"],is={key:2,class:"state-cell"},ds={class:"empty-state-content"},rs={class:"empty-state-icon-bg"},cs={class:"drawer-header"},us={class:"header-left"},ps={class:"drawer-title"},ms={key:0,class:"procedure-id"},vs={class:"drawer-footer"},_s={components:{ProcedureForm:K,SideDrawer:J}},fs=Object.assign(_s,{__name:"ProceduresListView",setup(V){const p=ee();se();const _=te(),m=G(()=>p.procedures),d=w(null),r=w(null),b=w(!1),v=w(!1);oe(async()=>{await p.fetchProcedures()});function t(u){d.value=d.value===u?null:u}function n(u){r.value={...u},b.value=!0,d.value=null}function C(){r.value={name:"",description:"",baseValue:0,pricingType:"FIXED"},b.value=!0}async function P(u){if(confirm("Tem certeza que deseja excluir este procedimento? Esta ação não pode ser desfeita.")){const{success:s}=await p.deleteProcedure(u);s?_.success("Procedimento excluído com sucesso!"):_.error(p.error||"Não foi possível excluir o procedimento.")}d.value=null}function $(){b.value=!1,r.value=null}async function Q(){if(!v.value){if(!r.value.name){_.error("O nome do procedimento é obrigatório.");return}if(r.value.baseValue<=0){_.error("O valor deve ser maior que zero.");return}v.value=!0;try{const u={...r.value};let s;u._id?(s=await p.updateProcedure(u._id,u),s.success&&_.success("Procedimento atualizado com sucesso!")):(s=await p.createProcedure(u),s.success&&_.success("Procedimento criado com sucesso!")),s.success?$():_.error(p.error||"Erro ao salvar procedimento.")}finally{v.value=!1}}}const M=u=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(u),T=u=>{switch(u){case"FIXED":return{label:"Preço Fixo",class:"tag-default"};case"ML":return{label:"Por ML",class:"tag-ml"};case"UNIT":return{label:"Unidade",class:"tag-unit"};default:return{label:u||"N/A",class:"tag-default"}}};return(u,s)=>{const U=R("click-outside"),W=R("auto-animate");return i(),c("div",Pe,[e("header",xe,[s[4]||(s[4]=e("div",{class:"header-text"},[e("h1",{class:"title"},"Procedimentos"),e("p",{class:"subtitle"},"Gerencie os procedimentos e seus valores.")],-1)),e("div",ze,[l(S,{variant:"primary",onClick:C,class:"add-procedure-btn"},{default:y(()=>[l(a(E),{size:16}),s[3]||(s[3]=h(" Adicionar Procedimento ",-1))]),_:1})])]),e("div",{class:F(["table-wrapper",{"is-loading":a(p).isLoading&&m.value.length>0}])},[e("div",$e,[e("table",null,[e("thead",null,[e("tr",null,[e("th",Te,[e("div",Ne,[l(a(N),{size:14}),s[5]||(s[5]=e("span",null,"Nome do Procedimento",-1))])]),e("th",null,[e("div",Ie,[l(a(le),{size:14}),s[6]||(s[6]=e("span",null,"Valor Base",-1))])]),e("th",De,[e("div",Le,[l(a(ae),{size:14}),s[7]||(s[7]=e("span",null,"Tipo",-1))])]),e("th",Ee,[e("div",Se,[l(a(ne),{size:14}),s[8]||(s[8]=e("span",null,"Ações",-1))])])])]),e("tbody",null,[a(p).isLoading&&m.value.length===0?(i(),c(I,{key:0},D(5,o=>e("tr",{key:`skel-desk-${o}`,class:"skeleton-row"},[...s[9]||(s[9]=[e("td",null,[e("div",{class:"skeleton skeleton-text",style:{width:"60%"}})],-1),e("td",null,[e("div",{class:"skeleton skeleton-text",style:{width:"40%"}})],-1),e("td",null,[e("div",{class:"skeleton skeleton-text",style:{width:"30%"}})],-1),e("td",{class:"actions-cell"},[e("div",{class:"skeleton skeleton-button"})],-1)])])),64)):!a(p).isLoading&&m.value.length===0?(i(),c("tr",Fe,[e("td",Be,[e("div",Me,[e("div",Ue,[l(a(N),{size:24})]),s[11]||(s[11]=e("h3",{class:"empty-state-title"},"Nenhum procedimento cadastrado",-1)),s[12]||(s[12]=e("p",{class:"empty-state-text"}," Comece adicionando um procedimento para gerenciar os valores. ",-1)),e("button",{onClick:C,class:"btn-primary-sm"},[l(a(E),{size:16}),s[10]||(s[10]=e("span",null,"Adicionar Procedimento",-1))])])])])):(i(!0),c(I,{key:2},D(m.value,o=>(i(),c("tr",{key:o._id,class:"procedure-row"},[e("td",Ae,[e("div",Re,[e("span",Oe,f(o.name),1),o.description?(i(),c("span",qe,f(o.description),1)):g("",!0)])]),e("td",Xe,f(M(o.baseValue)),1),e("td",je,[e("span",{class:F(["pricing-tag",T(o.pricingType).class])},f(T(o.pricingType).label),3)]),e("td",{class:"actions-cell",onClick:s[0]||(s[0]=k(()=>{},["stop"]))},[z((i(),c("div",He,[e("button",{onClick:k(x=>t(o._id),["stop"]),class:"btn-icon"},[l(a(O),{size:20})],8,Ge),l(j,{name:"fade"},{default:y(()=>[d.value===o._id?(i(),c("div",Je,[e("button",{onClick:k(x=>n(o),["stop"]),class:"dropdown-item"},[l(a(q),{size:14}),s[13]||(s[13]=h(" Editar ",-1))],8,Ke),e("button",{onClick:k(x=>P(o._id),["stop"]),class:"dropdown-item delete"},[l(a(X),{size:14}),s[14]||(s[14]=h(" Excluir ",-1))],8,Qe)])):g("",!0)]),_:2},1024)])),[[U,()=>d.value=null]])])]))),128))])])]),z((i(),c("div",We,[a(p).isLoading&&m.value.length===0?(i(),c(I,{key:0},D(5,o=>e("div",{key:`skel-mob-${o}`,class:"procedure-card skeleton-card"},[...s[15]||(s[15]=[ie('<div class="procedure-info-mobile" data-v-7d27bd0f><div class="procedure-details-mobile" data-v-7d27bd0f><div class="skeleton skeleton-text" data-v-7d27bd0f></div><div class="skeleton skeleton-text-sm" data-v-7d27bd0f></div></div></div><div class="skeleton skeleton-button" data-v-7d27bd0f></div>',2)])])),64)):m.value.length>0?(i(!0),c(I,{key:1},D(m.value,o=>(i(),c("div",{key:o._id,class:"procedure-card"},[e("div",Ye,[e("div",Ze,[l(a(N),{size:20})]),e("div",es,[e("span",ss,f(o.name),1),e("span",ts,f(M(o.baseValue)),1),e("span",{class:F(["pricing-tag mobile-tag",T(o.pricingType).class])},f(T(o.pricingType).label),3)])]),z((i(),c("div",{class:"actions-wrapper",onClick:s[1]||(s[1]=k(()=>{},["stop"]))},[e("button",{onClick:k(x=>t(o._id),["stop"]),class:"btn-icon"},[l(a(O),{size:20})],8,os),l(j,{name:"fade"},{default:y(()=>[d.value===o._id?(i(),c("div",ls,[e("button",{onClick:k(x=>n(o),["stop"]),class:"dropdown-item"},[l(a(q),{size:14}),s[16]||(s[16]=h(" Editar ",-1))],8,as),e("button",{onClick:k(x=>P(o._id),["stop"]),class:"dropdown-item delete"},[l(a(X),{size:14}),s[17]||(s[17]=h(" Excluir ",-1))],8,ns)])):g("",!0)]),_:2},1024)])),[[U,()=>d.value=null]])]))),128)):g("",!0),!a(p).isLoading&&m.value.length===0?(i(),c("div",is,[e("div",ds,[e("div",rs,[l(a(N),{size:24})]),s[19]||(s[19]=e("h3",{class:"empty-state-title"},"Nenhum procedimento cadastrado",-1)),s[20]||(s[20]=e("p",{class:"empty-state-text"},"Comece adicionando um procedimento para gerenciar os valores.",-1)),e("button",{onClick:C,class:"btn-primary-sm"},[l(a(E),{size:16}),s[18]||(s[18]=e("span",null,"Adicionar Procedimento",-1))])])])):g("",!0)])),[[W]])],2),b.value?(i(),L(J,{key:0,onClose:$},{header:y(()=>[e("div",cs,[e("div",us,[e("h2",ps,f(r.value._id?"Editar Procedimento":"Novo Procedimento"),1),r.value._id?(i(),c("span",ms," ID #"+f(r.value._id.slice(-6).toUpperCase()),1)):g("",!0)]),e("button",{onClick:$,class:"close-btn-header"},[l(a(H),{size:24})])])]),footer:y(()=>[e("div",vs,[l(S,{variant:"default",onClick:$,class:"btn-cancel"},{default:y(()=>[l(a(H),{size:18}),s[21]||(s[21]=h(" Cancelar ",-1))]),_:1}),l(S,{variant:"secondary",onClick:Q,class:"btn-save",disabled:v.value},{default:y(()=>[v.value?(i(),L(a(de),{key:0,size:18,class:"animate-spin"})):(i(),L(a(re),{key:1,size:18})),h(" "+f(r.value._id?"Salvar Alterações":"Criar Procedimento"),1)]),_:1},8,["disabled"])])]),default:y(()=>[l(K,{modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=o=>r.value=o)},null,8,["modelValue"])]),_:1})):g("",!0)])}}}),ys=B(fs,[["__scopeId","data-v-7d27bd0f"]]);export{ys as default};
